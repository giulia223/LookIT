@model LookIT.Models.Post

<h2 class="text-center mt-5">Adăugare postare</h2>
<br />

<div class="container mt-5">
    <div class="row">
        <div class="col-md-6 offset-md-3">
            <div class="card p-4 shadow-sm">

                <form method="post" asp-action="New" asp-controller="Posts" enctype="multipart/form-data">

                    <div asp-validation-summary="All" class="text-danger mb-3"></div>

                    <div class="form-group mb-3">
                        <label class="form-label fw-bold">Încarcă Imaginea</label>

                        <input type="file" name="Image" id="imageInput" class="form-control" accept="image/*" />
                        <small class="text-muted">Formate acceptate: jpg, jpeg, png, gif.</small>

                        <div id="imagePreviewContainer" class="mt-3 d-none text-center bg-light p-2 rounded">
                            <p class="mb-1 text-muted small">Previzualizare imagine:</p>
                            <img id="imagePreview" src="#" alt="Image Preview" class="img-fluid rounded border" style="max-height: 300px;" />
                        </div>
                    </div>

                    <div class="form-group mb-3">
                        <label class="form-label fw-bold">Încarcă Video</label>

                        <input type="file" name="Video" id="videoInput" class="form-control" accept="video/*" />
                        <small class="text-muted">Formate acceptate: MP4, WebM, etc.</small>

                        <div id="videoPreviewContainer" class="mt-3 d-none text-center bg-light p-2 rounded">
                            <p class="mb-1 text-muted small">Previzualizare video:</p>
                            <video id="videoPreview" controls class="w-100 rounded border" style="max-height: 300px;">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                    </div>

                    <div class="form-group">
                        <label asp-for="TextContent" class="form-label">Conținut text</label>
                        <br />
                        <textarea asp-for="TextContent" class="form-control" rows="4"></textarea>
                        <span asp-validation-for="TextContent" class="text-danger"></span>
                        <br />
                    </div>

                    <div class="d-grid">
                        <button class="btn btn-success" type="submit">Postează</button>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        const imageInput = document.getElementById('imageInput');
        const videoInput = document.getElementById('videoInput');

        const imgContainer = document.getElementById('imagePreviewContainer');
        const imgPreview = document.getElementById('imagePreview');

        const vidContainer = document.getElementById('videoPreviewContainer');
        const vidPreview = document.getElementById('videoPreview');

        imageInput.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                imgPreview.src = URL.createObjectURL(file);
                imgContainer.classList.remove('d-none');
            } else {
                imgContainer.classList.add('d-none');
            }    
        });

        videoInput.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                vidPreview.src = URL.createObjectURL(file);
                vidContainer.classList.remove('d-none');
            } else {
                vidContainer.classList.add('d-none');
            }
            
        });

    </script>
}